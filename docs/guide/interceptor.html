<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>拦截器 | Netty-Starter</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="Netty快速开发的高性能IO整合框架">
    
    <link rel="preload" href="/spring-boot-netty-starter/assets/css/0.styles.c48434c2.css" as="style"><link rel="preload" href="/spring-boot-netty-starter/assets/js/app.2662a8e6.js" as="script"><link rel="preload" href="/spring-boot-netty-starter/assets/js/2.b8bc1b17.js" as="script"><link rel="preload" href="/spring-boot-netty-starter/assets/js/17.e6d982c6.js" as="script"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/10.735ef0e8.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/11.18e13c56.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/12.4f88568e.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/13.54bc547b.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/14.bc8e198e.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/15.b80193b3.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/16.30d32fab.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/18.eb2929cb.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/19.71cf84d6.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/20.45c71554.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/21.d9bb49a9.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/22.6a34d6bc.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/23.b6b223ce.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/24.be51af9c.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/25.1f96f7f3.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/26.012e68b3.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/27.f341870f.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/28.2223476c.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/29.a0e4bd57.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/3.a91baf80.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/30.63ba3af6.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/4.06f6214b.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/5.05e225c9.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/6.dc8cf972.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/7.256e2f45.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/8.20c65693.js"><link rel="prefetch" href="/spring-boot-netty-starter/assets/js/9.6a38a202.js">
    <link rel="stylesheet" href="/spring-boot-netty-starter/assets/css/0.styles.c48434c2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/spring-boot-netty-starter/" class="home-link router-link-active"><img src="/spring-boot-netty-starter/access/logo.png" alt="Netty-Starter" class="logo"> <span class="site-name can-hide">Netty-Starter</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/spring-boot-netty-starter/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/spring-boot-netty-starter/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="/spring-boot-netty-starter/version/" class="nav-link">
  更新日志
</a></div><div class="nav-item"><a href="https://gitee.com/lee_coding/spring-boot-netty-starter" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/spring-boot-netty-starter/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/spring-boot-netty-starter/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="/spring-boot-netty-starter/version/" class="nav-link">
  更新日志
</a></div><div class="nav-item"><a href="https://gitee.com/lee_coding/spring-boot-netty-starter" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>指南</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/spring-boot-netty-starter/guide/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/spring-boot-netty-starter/guide/get-start.html" class="sidebar-link">起步(Get Start)</a></li><li><a href="/spring-boot-netty-starter/guide/context.html" class="sidebar-link">全局上下文(Context)</a></li><li><a href="/spring-boot-netty-starter/guide/auto-config.html" class="sidebar-link">配置(Configure)</a></li><li><a href="/spring-boot-netty-starter/guide/session-manage.html" class="sidebar-link">通道管理器(SessionManage)</a></li><li><a href="/spring-boot-netty-starter/guide/protocol.html" class="sidebar-link">协议(Protocol)</a></li><li><a href="/spring-boot-netty-starter/guide/handler.html" class="sidebar-link">处理器(Handler)</a></li><li><a href="/spring-boot-netty-starter/guide/interceptor.html" aria-current="page" class="active sidebar-link">拦截器(Interceptor)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/spring-boot-netty-starter/guide/interceptor.html#应用程序相关" class="sidebar-link">应用程序相关</a></li><li class="sidebar-sub-header"><a href="/spring-boot-netty-starter/guide/interceptor.html#处理器相关" class="sidebar-link">处理器相关</a></li><li class="sidebar-sub-header"><a href="/spring-boot-netty-starter/guide/interceptor.html#session相关" class="sidebar-link">Session相关</a></li><li class="sidebar-sub-header"><a href="/spring-boot-netty-starter/guide/interceptor.html#spring相关" class="sidebar-link">Spring相关</a></li></ul></li><li><a href="/spring-boot-netty-starter/guide/lambda.html" class="sidebar-link">Lambda监听器(Listener)</a></li><li><a href="/spring-boot-netty-starter/guide/annotation.html" class="sidebar-link">注解(Annotation)</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="拦截器"><a href="#拦截器" class="header-anchor">#</a> 拦截器</h1> <p>根据应用程序的生命周期将拦截器共分为四类十五种拦截器,接下来让我们一起看看他们各自的能力.</p> <ul><li>应用程序相关</li> <li>处理器相关</li> <li><code>Session</code>相关</li> <li><code>Spring</code>相关</li></ul> <div class="custom-block tip"><p class="custom-block-title">提示建议</p> <p>这些拦截器的实例并不是单例,他们只会存活在一个活动的<code>pipeline</code>之中,也就是说每一个客户端的拦截器都不会互相影响,他们各自是独立的</p></div> <h2 id="应用程序相关"><a href="#应用程序相关" class="header-anchor">#</a> 应用程序相关</h2> <ul><li>这一类型的拦截器接口仅对操作应用程序的生命周期有关</li></ul> <h3 id="applicationdestroy"><a href="#applicationdestroy" class="header-anchor">#</a> ApplicationDestroy</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在应用程序销毁的时候触发实现了该接口的所有类</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="beforedestroy"><a href="#beforedestroy" class="header-anchor">#</a> beforeDestroy()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#应用程序-applicationsession">ApplicationSession</a></li> <li>返回值: <code>void</code></li> <li>功能: 在程序销毁之前通知该方法.</li></ul> <h4 id="destroy"><a href="#destroy" class="header-anchor">#</a> destroy()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/context.html">Server</a></li> <li>返回值: <code>void</code></li> <li>功能: 在程序销毁后通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">ApplicationDestroy</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">ApplicationSession</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationDestroy</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token class-name">ApplicationSession</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;beforeDestroy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token class-name">Server</span> server<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;destroy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="处理器相关"><a href="#处理器相关" class="header-anchor">#</a> <a href="/spring-boot-netty-starter/guide/handler.html">处理器</a>相关</h2> <p>这一类型的拦截器接口仅对处理器的生命周期有关,他们的优先级是高于自定义的处理器的,会在自定义处理器之前拦截处理,如果这些类加入到<code>Spring</code>的<code>IOC</code>之中,他们将会是一个单例,反之则在每个客户端线程中重新诞生出一个单独的实例,但是需要注意实现这些接口的类必须拥有<code>无参构造器</code>,他们均已实现了<a href="/spring-boot-netty-starter/guide/session-manage.html#适配器-adaptersessionmanager">AdapterSessionManager</a>接口,也就是说实现他们的类可以对<a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a>进行管理</p> <h3 id="socketregistered"><a href="#socketregistered" class="header-anchor">#</a> SocketRegistered</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在连接尚未完全建立的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="registered"><a href="#registered" class="header-anchor">#</a> registered()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>返回值: <code>void</code></li> <li>功能: 在连接尚未完全建立的时候调通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketRegistered</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketRegistered</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registered</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;registered&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketunregistered"><a href="#socketunregistered" class="header-anchor">#</a> SocketUnregistered</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在连接断开的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="unregistered"><a href="#unregistered" class="header-anchor">#</a> Unregistered()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>返回值: <code>void</code></li> <li>功能: 在连接断开的时候通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketUnregistered</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketUnregistered</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Unregistered</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Unregistered&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketactive"><a href="#socketactive" class="header-anchor">#</a> SocketActive</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在连接成功的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="active"><a href="#active" class="header-anchor">#</a> active()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>返回值: <code>void</code></li> <li>功能: 在连接成功的时候通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketActive</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketActive</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">active</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;active&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketinactive"><a href="#socketinactive" class="header-anchor">#</a> SocketInactive</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在客户端离线的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="inactive"><a href="#inactive" class="header-anchor">#</a> inactive()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>返回值: <code>void</code></li> <li>功能: 在客户端离线的时候通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketInactive</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketInactive</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">inactive</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;inactive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketbeforereadmessage"><a href="#socketbeforereadmessage" class="header-anchor">#</a> SocketBeforeReadMessage</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在接收到消息之前的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="beforereadmessage"><a href="#beforereadmessage" class="header-anchor">#</a> beforeReadMessage()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>参数: <code>Object</code></li> <li>返回值: <code>void</code></li> <li>功能: 在接收到消息之前的时候通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketBeforeReadMessage</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketBeforeReadMessage</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">beforeReadMessage</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">,</span><span class="token class-name">Object</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;beforeReadMessage&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketmessage"><a href="#socketmessage" class="header-anchor">#</a> SocketMessage</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在接收到消息的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="readmessage"><a href="#readmessage" class="header-anchor">#</a> readMessage()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>参数: <code>Object</code></li> <li>返回值: <code>void</code></li> <li>功能: 在接收到消息的时候通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketMessage</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketMessage</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">readMessage</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">,</span><span class="token class-name">Object</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;readMessage&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketafterreadmessage"><a href="#socketafterreadmessage" class="header-anchor">#</a> SocketAfterReadMessage</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在接收到消息处理之后的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="afterreadmessage"><a href="#afterreadmessage" class="header-anchor">#</a> afterReadMessage()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>参数: <code>Object</code></li> <li>返回值: <code>void</code></li> <li>功能: 在接收到消息处理之后的时候通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketAfterReadMessage</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketAfterReadMessage</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterReadMessage</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">,</span><span class="token class-name">Object</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;afterReadMessage&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketcompletemessage"><a href="#socketcompletemessage" class="header-anchor">#</a> SocketCompleteMessage</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在接收到消息读取完成之后的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="completereadmessage"><a href="#completereadmessage" class="header-anchor">#</a> completeReadMessage()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>返回值: <code>void</code></li> <li>功能: 在接收到消息读取完成之后的时候通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketCompleteMessage</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketCompleteMessage</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">completeReadMessage</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;completeReadMessage&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketidle"><a href="#socketidle" class="header-anchor">#</a> SocketIdle</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在读写空闲的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="idle"><a href="#idle" class="header-anchor">#</a> idle()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>参数: <code>IdleStateEvent</code></li> <li>返回值: <code>void</code></li> <li>功能: 在读写空闲的时候通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>timeout<span class="token punctuation">.</span></span><span class="token class-name">IdleState</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>timeout<span class="token punctuation">.</span></span><span class="token class-name">IdleStateEvent</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketIdle</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketIdle</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">idle</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">,</span><span class="token class-name">IdleStateEvent</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;idle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketexceptioncapture"><a href="#socketexceptioncapture" class="header-anchor">#</a> SocketExceptionCapture</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在读写空闲的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="capture"><a href="#capture" class="header-anchor">#</a> capture()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>参数: <code>Throwable</code></li> <li>返回值: <code>void</code></li> <li>功能: 在捕获到错误的时候通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>timeout<span class="token punctuation">.</span></span><span class="token class-name">IdleState</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>timeout<span class="token punctuation">.</span></span><span class="token class-name">IdleStateEvent</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketIdle</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketIdle</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">capture</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">,</span><span class="token class-name">Throwable</span> err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;capture&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="session相关"><a href="#session相关" class="header-anchor">#</a> <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a>相关</h2> <p>这一类型的拦截器接口仅对<a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a>注册,注销的生命周期有关,通过对这个过程的监听可以很灵活的记录客户端的事件.</p> <h3 id="socketregisteredsession"><a href="#socketregisteredsession" class="header-anchor">#</a> SocketRegisteredSession</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在注册<a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a>的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="registerbefore"><a href="#registerbefore" class="header-anchor">#</a> registerBefore()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>返回值: <code>void</code></li> <li>功能: 在注册<a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a>之前通知该方法.</li></ul> <h4 id="registered-2"><a href="#registered-2" class="header-anchor">#</a> registered()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>返回值: <code>void</code></li> <li>功能: 在注册<a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a>完成后通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>timeout<span class="token punctuation">.</span></span><span class="token class-name">IdleState</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>timeout<span class="token punctuation">.</span></span><span class="token class-name">IdleStateEvent</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketRegisteredSession</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketRegisteredSession</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBefore</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      session<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token string">&quot;current_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;captregisterBeforeure&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
        <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registered</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;registered:id={}&quot;</span><span class="token punctuation">,</span>session<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="socketunregisteredsession"><a href="#socketunregisteredsession" class="header-anchor">#</a> SocketUnregisteredSession</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 在注销<a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a>的时候调用</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="removebefore"><a href="#removebefore" class="header-anchor">#</a> removeBefore()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>返回值: <code>void</code></li> <li>功能: 在注销<a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a>之前通知该方法.</li></ul> <h4 id="removed"><a href="#removed" class="header-anchor">#</a> removed()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a></li> <li>返回值: <code>void</code></li> <li>功能: 在注销<a href="/spring-boot-netty-starter/guide/session-manage.html#客户端-session">Session</a>完成后通知该方法.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>timeout<span class="token punctuation">.</span></span><span class="token class-name">IdleState</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>timeout<span class="token punctuation">.</span></span><span class="token class-name">IdleStateEvent</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SocketRegisteredSession</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>session<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SocketUnregisteredSession</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeBefore</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//save</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;captregisterBeforeure&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
        <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removed</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;registered:id={}&quot;</span><span class="token punctuation">,</span>session<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="spring相关"><a href="#spring相关" class="header-anchor">#</a> Spring相关</h2> <ul><li>这一类型的拦截器接口是对<code>Spring</code>容器以及运行时的一些支持,之所以这样做是因为在<code>Spring</code>中想要控制反转需要的注入和被注入都要加入到<code>Spring</code>的<code>IOC</code>容器中,在<code>Netty</code>的一些<code>Handler</code>之中我们又不想让这个类共享,但是又想让这个类能够注入.</li></ul> <h3 id="springinject"><a href="#springinject" class="header-anchor">#</a> SpringInject</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 任何实现此接口的类,会尝试加入到<code>Spring</code>的<code>IOC</code>容器中,但是这个类如果是一个<code>ChannelHandler</code>的类型,并且它没有被标注<code>ChannelHandler.Sharable</code>注解,将不会进行注册,只会进行注入,反之则会注入单例</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="setcontext"><a href="#setcontext" class="header-anchor">#</a> setContext()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: ApplicationContext</li> <li>返回值: <code>void</code></li> <li>功能: 对实现此接口的类注入<code>Spring</code>的应用程序上下文.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SpringInject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ApplicationContext</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SpringInject</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setContext</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;SpringInject&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="springcommandlinerunner"><a href="#springcommandlinerunner" class="header-anchor">#</a> SpringCommandLineRunner</h3> <ul><li>类型: <code>interface</code></li> <li>功能: 由于<code>Netty</code>是异步操作,加之设计的缘故,<code>Spring</code>的<code>CommandLineRunner</code>接口执行时<code>Netty</code>的服务还未完全启动完毕,所以设计此<code>SpringCommandLineRunner</code>接口用以在程序中代替<code>CommandLineRunner</code>接口</li></ul> <div class="custom-block tip"><p class="custom-block-title">钩子函数</p> <h4 id="run"><a href="#run" class="header-anchor">#</a> run()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <a href="/spring-boot-netty-starter/guide/context.html">SocketConfigurableContext</a></li> <li>返回值: <code>void</code></li> <li>功能: 程序启动完之后回调该方法,并注入服务器<a href="/spring-boot-netty-starter/guide/context.html">全局上下文</a>.</li></ul> <h4 id="getorder"><a href="#getorder" class="header-anchor">#</a> getOrder()</h4> <ul><li>类型: <code>Function</code></li> <li>参数: <code>viod</code></li> <li>返回值: <code>int</code></li> <li>功能: 同<code>Spring</code>的<code>Ordered</code>接口.</li></ul></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Ordered</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">SpringCommandLineRunner</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">site<span class="token punctuation">.</span>peaklee<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SocketConfigurableContext</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">SpringCommandLineRunner</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SocketConfigurableContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;SpringCommandLineRunner&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
        <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token class-name">SocketConfigurableContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;SpringCommandLineRunner&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token class-name">Ordered</span><span class="token punctuation">.</span><span class="token constant">LOWEST_PRECEDENCE</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/spring-boot-netty-starter/guide/handler.html" class="prev">
        处理器(Handler)
      </a></span> <span class="next"><a href="/spring-boot-netty-starter/guide/lambda.html">
        Lambda监听器(Listener)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/spring-boot-netty-starter/assets/js/app.2662a8e6.js" defer></script><script src="/spring-boot-netty-starter/assets/js/2.b8bc1b17.js" defer></script><script src="/spring-boot-netty-starter/assets/js/17.e6d982c6.js" defer></script>
  </body>
</html>
